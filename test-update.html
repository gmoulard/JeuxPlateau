<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Mise Ã  Jour</title>
</head>
<body>
    <h1>Test de la fonction de mise Ã  jour</h1>
    <button onclick="testUpdate()">ğŸ”„ Tester la mise Ã  jour</button>
    <div id="log" style="margin-top: 20px; padding: 10px; background: #f0f0f0; font-family: monospace; white-space: pre-wrap;"></div>

    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            logDiv.textContent += new Date().toLocaleTimeString() + ': ' + message + '\n';
        }

        async function testUpdate() {
            log('DÃ©but du test de mise Ã  jour...');
            
            try {
                // Test 1: VÃ©rifier les caches
                if ('caches' in window) {
                    const cacheNames = await caches.keys();
                    log(`Caches trouvÃ©s: ${cacheNames.length}`);
                    
                    // CrÃ©er un cache de test
                    const testCache = await caches.open('test-cache');
                    await testCache.put('/test', new Response('test'));
                    log('Cache de test crÃ©Ã©');
                    
                    // Vider tous les caches
                    const allCaches = await caches.keys();
                    await Promise.all(allCaches.map(name => caches.delete(name)));
                    log('Tous les caches vidÃ©s');
                    
                    // VÃ©rifier que les caches sont vidÃ©s
                    const remainingCaches = await caches.keys();
                    log(`Caches restants: ${remainingCaches.length}`);
                } else {
                    log('API Cache non supportÃ©e');
                }

                // Test 2: Service Worker
                if ('serviceWorker' in navigator) {
                    const registration = await navigator.serviceWorker.getRegistration();
                    if (registration) {
                        log('Service Worker trouvÃ©');
                        await registration.update();
                        log('Service Worker mis Ã  jour');
                    } else {
                        log('Aucun Service Worker trouvÃ©');
                    }
                } else {
                    log('Service Worker non supportÃ©');
                }

                log('Test terminÃ© avec succÃ¨s !');
                
            } catch (error) {
                log('Erreur: ' + error.message);
            }
        }

        // Auto-test au chargement
        window.addEventListener('load', () => {
            log('Page de test chargÃ©e');
        });
    </script>
</body>
</html>